function NestedMenu(d,e,h,j,b,f,a){var c=jQuery.noConflict();if(!a){a={axis:"y"}}var g=this;this.items=f;this.dataname=h;this.element=c("<li>").appendTo(c(e).children("ul"));this.index=d;this.moveHandle=c('<div class="move"></div>').appendTo(this.element);this.sortorder=c('<input type="hidden" name="'+h+'-sortorder[]" value="'+d+'" />').appendTo(this.element);this.id=c('<input type="hidden" name="'+h+"["+d+'][id]" class="id" />').appendTo(this.element);this.label=c('<input type="text" name="'+h+"["+d+'][name]" class="label" />').appendTo(this.element);this.deleteButton=c('<button type="button" class="delete"><img src="'+rsrcdir+'/core/ui/icons/delete.png" alt="Delete" width="16" height="16" /></button>').appendTo(this.element);if(this.items){if(f.type=="list"){this.itemsElement=c("<ul></ul>").appendTo(f.target).hide()}else{this.itemsElement=c("<li></li>").appendTo(f.target).hide()}}this.selected=function(){c(e).find("ul li").removeClass("selected");c(g.element).addClass("selected");if(f){c(f.target).children().hide();c(g.itemsElement).show()}};this.element.click(this.selected).hover(function(){c(this).addClass("hover")},function(){c(this).removeClass("hover")});this.label.mouseup(function(i){this.select()}).focus(function(){c(this).keydown(function(i){i.stopPropagation();if(i.keyCode==13){c(this).blur().unbind("keydown")}})});this.remove=function(){var i=c(e).find("input.deletes");if(c(g.id).val()!=""){i.val((i.val()=="")?c(g.id).val():i.val()+","+c(g.id).val())}if(f){g.itemsElement.remove()}g.element.remove()};this.deleteButton.click(this.remove);this.id.val(this.index);if(b&&b.id){this.id.val(b.id)}if(b&&b.name){this.label.val(htmlentities(b.name))}else{this.label.val(j+" "+this.index)}if(!c(e).children("ul").hasClass("ui-sortable")){c(e).children("ul").sortable(a)}else{c(e).children("ul").sortable("refresh")}}function NestedMenuContent(b,f,a,e){var d=jQuery.noConflict();var c=d('<textarea name="'+a+"["+b+'][content]" cols="40" rows="7"></textarea>').appendTo(f);if(e&&e.content){c.val(htmlentities(e.content))}}function NestedMenuOption(d,g,c,b,f){var e=jQuery.noConflict();var a=this;this.index=e(g).contents().length;this.element=e('<li class="option"></li>').appendTo(g);this.moveHandle=e('<div class="move"></div>').appendTo(this.element);this.id=e('<input type="hidden" name="'+c+"["+d+"][options]["+this.index+'][id]" class="id" />').appendTo(this.element);this.label=e('<input type="text" name="'+c+"["+d+"][options]["+this.index+'][name]" class="label" />').appendTo(this.element);this.deleteButton=e('<button type="button" class="delete"><img src="'+rsrcdir+'/core/ui/icons/delete.png" alt="delete" width="16" height="16" /></button>').appendTo(this.element);this.element.hover(function(){e(this).addClass("hover")},function(){e(this).removeClass("hover")});this.label.click(function(){this.select()});this.label.focus(function(){e(this).keydown(function(h){h.stopPropagation();if(h.keyCode==13){e(this).blur().unbind("keydown")}})});this.deleteButton.click(function(){e(a.element).remove()});this.id.val(this.index);if(f.id){this.id.val(f.id)}if(f.name){this.label.val(htmlentities(f.name))}if(!f.name){this.label.val(b+" "+(this.index+1))}}function addDetail(f){var e=jQuery.noConflict();var d=e("#details-menu");var a=e("#details-list");var h=detailsidx++;var g=new NestedMenu(h,d,"details","Detail Name",f,{target:a});if(f&&f.options){var b=e('<select name="details['+g.index+'][content]"></select>').appendTo(g.itemsElement);for(var c in f.options){e("<option>"+f.options[c]["name"]+"</option>").appendTo(b)}if(f&&f.content){b.val(htmlentities(f.content))}}else{g.item=new NestedMenuContent(g.index,g.itemsElement,"details",f)}if(!f||f.add){g.add=e('<input type="hidden" name="details['+g.index+'][new]" value="true" />').appendTo(g.element)}}function loadVariations(a,b){var c=jQuery.noConflict();if(a){c.each(a,function(d,e){addVariationOptionsMenu(e)});c.each(b,function(d,e){if(this.context=="variation"){addPriceLine("#variations-pricing",this.options.split(","),this)}});updateTabIndexes();c.each(a,function(d,e){c.each(e.options,function(f,g){if(g.linked=="on"){linkVariations(g.id)}})})}}function addVariationOptionsMenu(f){var e=jQuery.noConflict();var d=e("#variations-menu");var a=e("#variations-list");var c=e("#addVariationOption");var b=e("#linkOptionVariations");var h=variationsidx;var g=new NestedMenu(h,d,"options",OPTION_MENU_DEFAULT,f,{target:a,type:"list"},{axis:"y",update:function(){orderOptions(d,a)}});g.addOption=function(j){var k=false;if(!j){j=new Object()}if(!j.id){k=true;j.id=optionsidx}else{if(j.id>optionsidx){optionsidx=j.id}}var i=new NestedMenuOption(g.index,g.itemsElement,"options",NEW_OPTION_DEFAULT,j);optionsidx++;i.linkIcon=e('<img src="'+rsrcdir+'/core/ui/icons/linked.png" alt="linked" width="16" height="16" class="link" />').appendTo(i.moveHandle);i.linked=e('<input type="hidden" name="options['+g.index+"][options]["+i.index+'][linked]" class="linked" />').appendTo(i.element);i.linked.change(function(){if(e(this).val()=="off"){i.linkIcon.addClass("invisible")}if(e(this).val()=="on"){i.linkIcon.removeClass("invisible")}});if(j.linked){i.linked.val(j.linked).change()}else{i.linked.val("off").change()}i.selected=function(){if(i.element.hasClass("selected")){a.find("ul li").removeClass("selected");selectedMenuOption=false}else{a.find("ul li").removeClass("selected");e(i.element).addClass("selected");selectedMenuOption=i}b.change()};i.element.click(i.selected);productOptions[i.id.val()]=i.label;i.label.blur(function(){updateVariationLabels()});i.deleteButton.unbind("click");i.deleteButton.click(function(){if(g.itemsElement.children().length==1){deleteVariationPrices([i.id.val()],true)}else{deleteVariationPrices([i.id.val()])}i.element.remove()});if(!k){addVariationPrices(i.id.val())}else{addVariationPrices()}g.items.push(i)};g.items=new Array();if(f&&f.options){e.each(f.options,function(){g.addOption(this)})}else{g.addOption();g.addOption()}g.itemsElement.sortable({axis:"y",update:function(){orderVariationPrices()}});g.element.unbind("click",g.click);g.element.click(function(){g.selected();e(c).unbind("click").click(g.addOption)});optionMenus[variationsidx++]=g;g.deleteButton.unbind("click");g.deleteButton.click(function(){var i=new Array();e(g.itemsElement).find("li").not(".ui-sortable-helper").find("input.id").each(function(j,k){i.push(e(k).val())});deleteVariationPrices(i,true);g.remove()})}function linkVariations(b){if(!b){return}var c=jQuery.noConflict();for(var a in pricingOptions){if(c.inArray(b.toString(),pricingOptions[a].options)!=-1){if(!linkedPricing[b]){linkedPricing[b]=new Array()}linkedPricing[b].push(a);pricingOptions[a].linkInputs(b)}}}function unlinkVariations(a){if(!a){return}var b=jQuery.noConflict();if(!linkedPricing[a]){return}b.each(linkedPricing[a],function(d,c){pricingOptions[c].unlinkInputs(a)});linkedPricing.splice(a,1)}function updateVariationLinks(){var c=jQuery.noConflict();if(!linkedPricing){return}for(var a in pricingOptions){pricingOptions[a].unlinkInputs()}for(var b in linkedPricing){linkedPricing[b]=false;linkVariations(b)}}function buildVariations(){var e=jQuery.noConflict();var m=new Array();var j=e("#variations-list ul");var f=j.length;var a=f-1;var k=new Array(j.length);var d=new Array(j.length);var b=0;j.each(function(n,i){d[n]=e(i).children().length;if(b==0){b=e(i).children().length}else{b=b*e(i).children().length}k[n]=0});for(var c=0;c<b;c++){for(var l=0;l<j.length;l++){var g=e(j[l]).children("li").not(".ui-sortable-helper").children("input.id");if(!m[c]){m[c]=[e(g[k[l]]).val()]}else{m[c].push(e(g[k[l]]).val())}}if(++k[a]>=d[a]){for(var h=a;h>-1;h--){if(k[h]<d[h]){continue}k[h]=0;if(h-1>-1){k[(h-1)]++}}}}return m}function addVariationPrices(f){var e=jQuery.noConflict();if(!f){var a=buildVariations();var d=e("#variations-pricing");var c=e(d).children();var b=false;e(a).each(function(j,g){var h=xorkey(g);var i=xorkey(g.slice(0,g.length-1));if(i==""){i=-1}if(!pricingOptions[h]){if(pricingOptions[i]){pricingOptions[h]=pricingOptions[i];delete pricingOptions[i];pricingOptions[h].options=g;pricingOptions[h].updateKey();pricingOptions[h].updateLabel()}else{if(c.length==0){addPriceLine("#variations-pricing",g,{context:"variation"})}else{addPriceLine(pricingOptions[xorkey(a[(j-1)])].row,g,{context:"variation"},"after")}b=true}}});if(b){updateTabIndexes();updateVariationLinks()}}}function updateTabIndexes(){var b=jQuery.noConflict();var a=b("#variations-pricing").children();b.each(a,function(d,c){key=b(c).find(".pricing-label input.optionkey").val();pricingOptions[key].updateTabindex(d)})}function deleteVariationPrices(d,e){var c=jQuery.noConflict();var b=buildVariations();var a=false;c(b).each(function(m,g){var k=xorkey(g);for(var j=0;j<d.length;j++){if(g.indexOf(d[j])!=-1){var l=new Array();c(g).each(function(i,n){if(n!=d[j]){l.push(n)}});var f=xorkey(l);if(e&&!pricingOptions[f]){if(f!=0){pricingOptions[f]=pricingOptions[k]}else{pricingOptions[k].row.remove()}delete pricingOptions[k];if(pricingOptions[f]){pricingOptions[f].options=l;pricingOptions[f].updateLabel();pricingOptions[f].updateKey();a=true}}else{if(pricingOptions[k]){var h=c("#priceid-"+pricingOptions[k].id).val();if(c("#deletePrices").val()==""){c("#deletePrices").val(h)}else{c("#deletePrices").val(c("#deletePrices").val()+","+h)}pricingOptions[k].row.remove();delete pricingOptions[k]}}}}});if(a){updateVariationLinks()}}function optionMenuExists(a){var c=jQuery.noConflict();if(!a){return false}var b=false;c.each(optionMenus,function(e,d){if(d&&c(d.label).val()==a){b=e;return true}});if(optionMenus[b]){return optionMenus[b]}return b}function optionMenuItemExists(d,a){var c=jQuery.noConflict();if(!d||!d.items||!a){return false}var b=false;c.each(d.items,function(f,e){if(e&&c(e.label).val()==a){b=true;return true}});return b}function updateVariationLabels(){var b=jQuery.noConflict();var a=buildVariations();b(a).each(function(e,c){var d=xorkey(c);if(pricingOptions[d]){pricingOptions[d].updateLabel()}})}function orderOptions(d,a){var c=jQuery.noConflict();var b=c(d).find("ul li").not(".ui-sortable-helper").find("input.id");c(b).each(function(e,f){if(f){c(optionMenus[c(f).val()].itemsElement).appendTo(a)}});orderVariationPrices()}function orderVariationPrices(){var b=jQuery.noConflict();var a=buildVariations();b(a).each(function(e,c){var d=xorkey(c);if(d>0&&pricingOptions[d]){pricingOptions[d].row.appendTo("#variations-pricing");pricingOptions[d].options=c;pricingOptions[d].updateLabel()}})}function xorkey(c){for(var b=0,a=0;a<c.length;a++){b=b^(c[a]*7001)}return b}function variationsToggle(){var a=jQuery.noConflict();if(a("#variations-setting").attr("checked")){pricingOptions[0].disable();a("#product-pricing").hide();a("#variations").show()}else{a("#variations").hide();a("#product-pricing").show()}}function linkVariationsButton(){var b=jQuery.noConflict();if(selectedMenuOption){if(selectedMenuOption.linked.val()=="off"){if(linkedPricing[0]){for(var a in pricingOptions){pricingOptions[a].unlinkInputs(0)}linkedPricing.splice(0,1)}selectedMenuOption.linked.val("on").change();linkVariations(selectedMenuOption.id.val())}else{selectedMenuOption.linked.val("off").change();unlinkVariations(selectedMenuOption.id.val())}}else{if(linkedPricing[0]){for(var a in pricingOptions){pricingOptions[a].unlinkInputs(0)}linkedPricing.splice(0,1)}else{linkedPricing=new Array();linkedPricing[0]=new Array();for(var a in pricingOptions){linkedPricing[0].push(a);pricingOptions[a].linkInputs(0)}}}b(this).change()}function linkVariationsButtonLabel(){var a=jQuery.noConflict();if(selectedMenuOption){if(selectedMenuOption.linked.val()=="on"){a(this).find("small").html(" "+UNLINK_VARIATIONS)}else{a(this).find("small").html(" "+LINK_VARIATIONS)}}else{if(linkedPricing[0]){a(this).find("small").html(" "+UNLINK_ALL_VARIATIONS)}else{a(this).find("small").html(" "+LINK_ALL_VARIATIONS)}}}function readableFileSize(b){var a=new Array("bytes","KB","MB","GB");var d=b*1;if(d==0){return d}var c=0;while(d>1000){d=d/1024;c++}return d.toFixed(2)+" "+a[c]}function unsavedChanges(){var a=typeof(tinyMCE)!="undefined"?tinyMCE.activeEditor:false,c,b;if(a&&!a.isHidden()){if(a.isDirty()){return UNSAVED_CHANGES_WARNING}}if(changes&&!saving){return UNSAVED_CHANGES_WARNING}}function ImageUploads(id,type){(function($){var swfu;var settings={button_text:'<span class="button">'+ADD_IMAGE_BUTTON_TEXT+"</span>",button_text_style:'.button { text-align: center; font-family:"Lucida Grande","Lucida Sans Unicode",Tahoma,Verdana,sans-serif; font-size: 9px; color: #333333; }',button_text_top_padding:3,button_height:"22",button_width:"100",button_image_url:rsrcdir+"/core/ui/icons/buttons.png",button_placeholder_id:"swf-uploader-button",upload_url:ajaxurl,flash_url:rsrcdir+"/core/ui/behaviors/swfupload/swfupload.swf",file_queue_limit:1,file_size_limit:filesizeLimit+"b",file_types:"*.jpg;*.jpeg;*.png;*.gif",file_types_description:"Web-compatible Image Files",file_upload_limit:filesizeLimit,post_params:{action:"shopp_add_image",type:id},swfupload_loaded_handler:swfuLoaded,file_queued_handler:imageFileQueued,file_queue_error_handler:imageFileQueueError,file_dialog_complete_handler:imageFileDialogComplete,upload_start_handler:startImageUpload,upload_progress_handler:imageUploadProgress,upload_error_handler:imageUploadError,upload_success_handler:imageUploadSuccess,upload_complete_handler:imageUploadComplete,queue_complete_handler:imageQueueComplete,custom_settings:{loaded:false,targetHolder:false,progressBar:false,sorting:false},debug:false};if(wp26){settings.button_image_url=rsrcdir+"/core/ui/icons/wp26button.png";settings.button_height="26";settings.button_width="100";settings.button_text_style='.button { text-align: center; font-family:"Lucida Grande","Lucida Sans Unicode",Tahoma,Verdana,sans-serif; font-size: 11px; color: #284464; }'}if(flashuploader){swfu=new SWFUpload(settings)}var browserImageUploader=$("#image-upload").upload({name:"Filedata",action:ajaxurl,enctype:"multipart/form-data",params:{action:"shopp_add_image",type:id},autoSubmit:true,onSubmit:function(){var cell=$('<li id="image-uploading"></li>').appendTo($("#lightbox"));var sorting=$('<input type="hidden" name="images[]" value="" />').appendTo(cell);var progress=$('<div class="progress"></div>').appendTo(cell);var bar=$('<div class="bar"></div>').appendTo(progress);var art=$('<div class="gloss"></div>').appendTo(progress);this.targetHolder=cell;this.progressBar=bar;this.sorting=sorting},onComplete:function(results){if(results==""){$(this.targetHolder).remove();alert(SERVER_COMM_ERROR);return true}var image=eval("("+results+")");if(image.error){$(this.targetHolder).remove();alert(image.error);return true}$(this.targetHolder).attr({id:"image-"+image.src});$(this.sorting).val(image.src);var img=$('<img src="?shopp_image='+image.id+'" width="96" height="96" class="handle" />').appendTo(this.targetHolder).hide();var deleteButton=$('<button type="button" name="deleteImage" value="'+image.src+'" title="Delete product image&hellip;" class="deleteButton"></button>').appendTo($(this.targetHolder)).hide();var deleteIcon=$('<img src="'+rsrcdir+'/core/ui/icons/delete.png" alt="-" width="16" height="16" />').appendTo(deleteButton);$(this.progressBar).animate({width:"76px"},250,function(){$(this).parent().fadeOut(500,function(){$(this).remove();$(img).fadeIn("500");enableDeleteButton(deleteButton)})})}});$(document).load(function(){if(!swfu.loaded){$("#product-images .swfupload").remove()}});if($("#lightbox li").size()>0){$("#lightbox").sortable({opacity:0.8})}$("#lightbox li").each(function(){$(this).dblclick(function(){var id=$(this).attr("id")+"-details";$(this).find("input.close").click(function(){tb_remove()});tb_show("Image Details","#TB_inline?height=125&width=320&inlineId="+id)});enableDeleteButton($(this).find("button.deleteButton"))});function swfuLoaded(){$("#browser-uploader").hide();swfu.loaded=true}function imageFileQueued(file){}function imageFileQueueError(file,error,message){if(error==SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED){alert("You selected too many files to upload at one time. "+(message===0?"You have reached the upload limit.":"You may upload "+(message>1?"up to "+message+" files.":"only one file.")));return}else{alert(message)}}function imageFileDialogComplete(selected,queued){try{this.startUpload()}catch(ex){this.debug(ex)}}function startImageUpload(file){var cell=$('<li class="image uploading"></li>').appendTo($("#lightbox"));var sorting=$('<input type="hidden" name="images[]" value="" />').appendTo(cell);var progress=$('<div class="progress"></div>').appendTo(cell);var bar=$('<div class="bar"></div>').appendTo(progress);var art=$('<div class="gloss"></div>').appendTo(progress);this.targetHolder=cell;this.progressBar=bar;this.sorting=sorting;return true}function imageUploadProgress(file,loaded,total){var progress=Math.ceil((loaded/total)*76);$(this.progressBar).animate({width:progress+"px"},100)}function imageUploadError(file,error,message){}function imageUploadSuccess(file,results){var image=eval("("+results+")");if(image.error){$(this.targetHolder).remove();alert(image.error);return true}$(this.targetHolder).attr({id:"image-"+image.src});$(this.sorting).val(image.src);var img=$('<img src="?shopp_image='+image.id+'" width="96" height="96" class="handle" />').appendTo(this.targetHolder).hide();var deleteButton=$('<button type="button" name="deleteImage" value="'+image.src+'" title="Delete product image&hellip;" class="deleteButton"></button>').appendTo($(this.targetHolder)).hide();var deleteIcon=$('<img src="'+rsrcdir+'/core/ui/icons/delete.png" alt="-" width="16" height="16" />').appendTo(deleteButton);$(this.progressBar).animate({width:"76px"},250,function(){$(this).parent().fadeOut(500,function(){$(this).remove();$(img).fadeIn("500");enableDeleteButton(deleteButton)})})}function imageUploadComplete(file){}function imageQueueComplete(uploads){if($("#lightbox li").size()>1){$("#lightbox").sortable("refresh")}else{$("#lightbox").sortable()}}function enableDeleteButton(button){$(button).hide();$(button).parent().hover(function(){$(button).show()},function(){$(button).hide()});$(button).click(function(){if(confirm(DELETE_IMAGE_WARNING)){$("#deleteImages").val(($("#deleteImages").val()=="")?$(button).val():$("#deleteImages").val()+","+$(button).val());$(button).parent().fadeOut(500,function(){$(this).remove()})}})}})(jQuery)}function FileUploader(button,defaultButton,linenum,updates){var _self=this;(function($){_self.settings={button_text:'<span class="button">'+UPLOAD_FILE_BUTTON_TEXT+"</span>",button_text_style:'.button { text-align: center; font-family:"Lucida Grande","Lucida Sans Unicode",Tahoma,Verdana,sans-serif; font-size: 9px; color: #333333; }',button_text_top_padding:3,button_height:"22",button_width:"100",button_image_url:rsrcdir+"/core/ui/icons/buttons.png",button_placeholder_id:button,flash_url:rsrcdir+"/core/ui/behaviors/swfupload/swfupload.swf",upload_url:ajaxurl,file_queue_limit:1,file_size_limit:filesizeLimit+"b",file_types:"*.*",file_types_description:"All Files",file_upload_limit:filesizeLimit,post_params:{action:"shopp_add_download"},swfupload_loaded_handler:swfuLoaded,file_queue_error_handler:fileQueueError,file_dialog_complete_handler:fileDialogComplete,upload_start_handler:startUpload,upload_progress_handler:uploadProgress,upload_error_handler:uploadError,upload_success_handler:uploadSuccess,upload_complete_handler:uploadComplete,custom_settings:{loaded:false,targetCell:false,targetLine:false,progressBar:false},debug:false};if(wp26){_self.settings.button_image_url=rsrcdir+"/core/ui/icons/wp26button.png";_self.settings.button_height="26";_self.settings.button_width="100";_self.settings.button_text_style='.button { text-align: center; font-family:"Lucida Grande","Lucida Sans Unicode",Tahoma,Verdana,sans-serif; font-size: 11px; color: #284464; }'}if(flashuploader){_self.swfu=new SWFUpload(_self.settings);_self.swfu.targetCell=updates;_self.swfu.targetLine=linenum}defaultButton.upload({name:"Filedata",action:ajaxurl,enctype:"multipart/form-data",params:{action:"shopp_add_download"},autoSubmit:true,onSubmit:function(){updates.attr("class","").html("");var progress=$('<div class="progress"></div>').appendTo(updates);var bar=$('<div class="bar"></div>').appendTo(progress);var art=$('<div class="gloss"></div>').appendTo(progress);this.targetHolder=updates;this.progressBar=bar},onComplete:function(results){var filedata=eval("("+results+")");if(filedata.error){$(this.targetHolder).html("No download file.");alert(filedata.error);return true}var targetHolder=this.targetHolder;filedata.type=filedata.type.replace(/\//gi," ");$(this.progressBar).animate({width:"76px"},250,function(){$(this).parent().fadeOut(500,function(){$(targetHolder).attr("class","file "+filedata.type).html(filedata.name+"<br /><small>"+readableFileSize(filedata.size)+'</small><input type="hidden" name="price['+linenum+'][download]" value="'+filedata.id+'" />');$(this).remove()})})}});$(_self).load(function(){if(!_self.swfu.loaded){$(defaultButton).parent().parent().find(".swfupload").remove()}});function swfuLoaded(){$(defaultButton).hide();this.loaded=true}function fileQueueError(file,error,message){if(error==SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED){alert("You selected too many files to upload at one time. "+(message===0?"You have reached the upload limit.":"You may upload "+(message>1?"up to "+message+" files.":"only one file.")));return}else{alert(message)}}function fileDialogComplete(selected,queued){try{this.startUpload()}catch(ex){this.debug(ex)}}function startUpload(file){this.targetCell.attr("class","").html("");var progress=$('<div class="progress"></div>').appendTo(this.targetCell);var bar=$('<div class="bar"></div>').appendTo(progress);var art=$('<div class="gloss"></div>').appendTo(progress);this.progressBar=bar;return true}function uploadProgress(file,loaded,total){var progress=Math.ceil((loaded/total)*76);$(this.progressBar).animate({width:progress+"px"},100)}function uploadError(file,error,message){}function uploadSuccess(file,results){var filedata=eval("("+results+")");if(filedata.error){$(this.targetHolder).html(no_download);alert(filedata.error);return true}var targetCell=this.targetCell;var i=this.targetLine;filedata.type=filedata.type.replace(/\//gi," ");$(this.progressBar).animate({width:"76px"},250,function(){$(this).parent().fadeOut(500,function(){$(this).remove();$(targetCell).attr("class","file "+filedata.type).html(filedata.name+"<br /><small>"+readableFileSize(filedata.size)+'</small><input type="hidden" name="price['+i+'][download]" value="'+filedata.id+'" />')})})}function uploadComplete(file){}})(jQuery)}function SlugEditor(c,b){var a=this;(function(d){a.edit_permalink=function(){var f,k=0;var h=d("#editable-slug");var e=h.html();var m=d("#slug_input");var n=m.html();var l=d("#edit-slug-buttons");var j=l.html();var g=d("#editable-slug-full").html();l.html('<button type="button" class="save button">'+SAVE_BUTTON_TEXT+'</button> <button type="button" class="cancel button">'+CANCEL_BUTTON_TEXT+"</button>");l.children(".save").click(function(){var i=h.children("input").val();d.post(editslug_url+"&action=wp_ajax_shopp_edit_slug",{id:c,type:b,slug:i},function(o){h.html(e);l.html(j);if(o!=-1){h.html(o);d("#editable-slug-full").html(o);m.val(o)}a.enable()},"text")});d("#edit-slug-buttons .cancel").click(function(){h.html(e);l.html(j);m.attr("value",n);a.enable()});for(f=0;f<g.length;++f){if("%"==g.charAt(f)){k++}}slug_value=(k>g.length/4)?"":g;h.html('<input type="text" id="new-post-slug" value="'+slug_value+'" />').children("input").keypress(function(o){var i=o.which;if(i==13||i==27){o.preventDefault()}if(13==i){l.children(".save").click()}if(27==i){l.children(".cancel").click()}m.val(this.value)}).focus()};a.enable=function(){d("#edit-slug-buttons").children(".edit-slug").click(function(){a.edit_permalink()});d("#editable-slug").click(function(){d("#edit-slug-buttons").children(".edit-slug").click()})};a.enable()})(jQuery)};